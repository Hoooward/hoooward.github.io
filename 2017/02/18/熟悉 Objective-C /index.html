<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 编写高质量的 Objective-C 代码 1. 熟悉 Objective-C · Hexo</title><meta name="description" content="编写高质量的 Objective-C 代码 1. 熟悉 Objective-C - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Hexo"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/1855353313/" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/Hoooward" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">编写高质量的 Objective-C 代码 1. 熟悉 Objective-C</h1><div class="post-info">Feb 18, 2017</div><div class="post-content"><p>因为好久没写 OC 代码了，回头重看 《Effective Objective-C 编写高质量 iOS 与 OS X 代码的 52 个有效方法》，总结一些 OC 编码时的技巧。</p>
<h3 id="熟悉-Objective-C"><a href="#熟悉-Objective-C" class="headerlink" title="熟悉 Objective-C"></a>熟悉 Objective-C</h3><h5 id="1-除非必要，否则不要引入头文件"><a href="#1-除非必要，否则不要引入头文件" class="headerlink" title="1. 除非必要，否则不要引入头文件"></a>1. 除非必要，否则不要引入头文件</h5><p>一般来说，应再某个类的头文件中使用向前声明来提及某个类，并在实现文件（.m）中引入那些类的头文件，以降低类之间的耦合。<br>当无法使用向前声明时，比如要声明某个类遵循某个协议。在这种情况下，尽量把<code>该类遵循某协议</code>的声明移入<code>class-continuation 分类</code>中。如果不行的话，就把某协议单独放在一个头文件中，然后将其引入。</p>
<h5 id="2-尽量使用字面量创建数组、字典、字符串、数值"><a href="#2-尽量使用字面量创建数组、字典、字符串、数值" class="headerlink" title="2. 尽量使用字面量创建数组、字典、字符串、数值"></a>2. 尽量使用字面量创建数组、字典、字符串、数值</h5><p>与常规方法相比更加简明。同时，如果值中有 nil，则会抛出异常，方便定位问题。而使用常规方法遇到 nil 会自动结束向集合添加数值。<br><a id="more"></a></p>
<h5 id="3-避免使用-define-预处理命令定义常量"><a href="#3-避免使用-define-预处理命令定义常量" class="headerlink" title="3. 避免使用 #define 预处理命令定义常量"></a>3. 避免使用 #define 预处理命令定义常量</h5><p>因为这样定义出来的常量不含类型信息，仅做预编译阶段的替换操作。无法利用编译器产生警告信息。<br>应该选择在实现文件中使用 <code>static（定义作用域） const（readOnly）</code> 来定义只在编译单元内可见的常量，此常量不在全局符号表中，无需加前缀。<br>如果需要定义全局常量，选择在头文件中使用 <code>extern</code>.并在相关实现文件中初始化其值，因为这种常量会出现再全局符号表中，所以应该加前缀，通常使用与之相关的类名做前缀。（OC 没有命名空间）。</p>
<h5 id="4-使用枚举表示状态、选项、状态码"><a href="#4-使用枚举表示状态、选项、状态码" class="headerlink" title="4. 使用枚举表示状态、选项、状态码"></a>4. 使用枚举表示状态、选项、状态码</h5><p>应该使用枚举来表示状态机的状态、传递给方法的选择以及状态码等值，给这些值起个易懂的名字。<br>如果把传递给某个方法的选项用枚举表示，而多个选择又可以同时使用，那么就将各选项值定义为 2 的幂，以便通过按位或操作将其组合起来。<br>用 <code>NS_ENUM</code> 与 <code>NS_OPTIONS</code> 宏来定义枚举类型，并指明底层数据类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">typedef NS_ENUM(NSUInteger, EOCConnectionState) &#123;</div><div class="line">	EOCConnectionStateDisconnected,</div><div class="line">	EOCConnectionStateConnecting,</div><div class="line">	EOCConnectionStateConnected,</div><div class="line">&#125;</div><div class="line"></div><div class="line">typedef NS_OPTIONS(NSUInteger, EOCPermittedDirection) &#123;</div><div class="line">	EOCPermittedDirectionUp    = 1 &lt;&lt; 0,</div><div class="line">	EOCPermittedDirectionDown  = 1 &lt;&lt; 1,</div><div class="line">	EOCPermittedDirectionLeft  = 1 &lt;&lt; 2,</div><div class="line">	EOCPermittedDirectionRight = 1 &lt;&lt; 3,</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</div></article></div></section><footer><div class="paginator"><a href="/2017/02/19/对象、消息、运行时 /" class="prev">PREV</a><a href="/2016/11/28/git总结/" class="next">NEXT</a></div><div data-thread-key="2017/02/18/熟悉 Objective-C /" data-title="编写高质量的 Objective-C 代码 1. 熟悉 Objective-C" data-url="http://yoursite.com/2017/02/18/熟悉 Objective-C /" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"seansun"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2015 - 2017 <a href="http://yoursite.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>